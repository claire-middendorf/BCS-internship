

--Portland General Electric (46)
with subset as
(
select descr 
from dev.budget_staging 
where descr not similar to '[A-Z]{3};%' 
		and descr not similar to '% [A-Z]{1}. %'
		and descr not similar to 'SR%' 
		and descr not similar to 'sr%'
		and descr not similar to '[0-9]{4}%'
		and descr not similar to '%Sierra Springs%'
		and descr not similar to '%sierra springs%'
		and descr not similar to '%BonApp%'
		and descr not similar to '%Year-End%'
		and descr not similar to '%LLC%' 
		and descr not similar to '%Pepsi%'
		and descr not similar to '%Canteen%'
		and descr not similar to '%Shred-it%'
		and descr not similar to '%University%'
		and descr not similar to '%College%'
		and descr not similar to '%Print%'
		and descr not similar to '%print%' 
		and descr not similar to 'Dept%'
) 
select 
	case when descr similar to '%Portland General Electric%'  then 'Portland General Electric' 
	else null end as pattern_planttender
	, count(*) as row_count 
from subset 
where descr similar to '%Portland General Electric%'  
group by case when descr similar to '%Portland General Electric%'  then 'Portland General Electric'
	else null end
order by row_count desc  

--42 rows


